<!-- Borrowed mostly from https://github.com/disqus/disqus-install-examples/tree/master/google-amp -->
<div id="disqus_thread"></div>
<script>
window.addEventListener('message', receiveMessage, false);
function receiveMessage(event)
{
    if (event.data) {
        var msg;
        try {
            msg = JSON.parse(event.data);
        } catch (err) {
            // Do nothing
        }
        if (!msg)
            return false;

        if (msg.name === 'resize') {

            window.parent.postMessage({
              sentinel: 'amp',
              type: 'embed-size',
              height: msg.data.height
            }, '*');
        }
    }
}
</script>
<script>
function getUrlVar(UrlVar) {
	queryStr = window.location.search;
	queryStr = queryStr.substring(1);
	var urlArray = queryStr.split("&");
	for (var inc = 0; inc < urlArray.length;inc++) { //>
		var tempArray = urlArray[inc].split("=");
		if (UrlVar == tempArray[0]){
			return tempArray[1];
		}
	}
}
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    var disqus_config = function () {
        this.page.url = decodeURIComponent(getUrlVar('current_url'));  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = getUrlVar('unique_id'); // Replace PAGE_IDENTIFIER with your page's unique identifier variable
	console.log("this.page.url: " + this.page.url);
    };
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        //s.src = '//EXAMPLE.disqus.com/embed.js';
	s.src = "//" + getUrlVar("disqus_shortname") + ".disqus.com/embed.js";
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
